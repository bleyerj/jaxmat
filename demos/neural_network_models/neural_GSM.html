
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Neural Generalized Standard Material for viscoelasticity &#8212; jaxmat</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "displayMath": [["$$", "$$"], ["\\[", "\\]"]], "macros": {"ba": "\\boldsymbol{a}", "bb": "\\boldsymbol{b}", "bc": "\\boldsymbol{c}", "bd": "\\boldsymbol{d}", "be": "\\boldsymbol{e}", "bf": "\\boldsymbol{f}", "bg": "\\boldsymbol{g}", "bh": "\\boldsymbol{h}", "bi": "\\boldsymbol{i}", "bj": "\\boldsymbol{j}", "bk": "\\boldsymbol{k}", "bl": "\\boldsymbol{l}", "bm": "\\boldsymbol{m}", "bn": "\\boldsymbol{n}", "bo": "\\boldsymbol{o}", "bp": "\\boldsymbol{p}", "bq": "\\boldsymbol{q}", "br": "\\boldsymbol{r}", "bs": "\\boldsymbol{s}", "bt": "\\boldsymbol{t}", "bu": "\\boldsymbol{u}", "bv": "\\boldsymbol{v}", "bw": "\\boldsymbol{w}", "bx": "\\boldsymbol{x}", "by": "\\boldsymbol{y}", "bz": "\\boldsymbol{z}", "bA": "\\boldsymbol{A}", "bB": "\\boldsymbol{B}", "bC": "\\boldsymbol{C}", "bD": "\\boldsymbol{D}", "bE": "\\boldsymbol{E}", "bF": "\\boldsymbol{F}", "bG": "\\boldsymbol{G}", "bH": "\\boldsymbol{H}", "bI": "\\boldsymbol{I}", "bJ": "\\boldsymbol{J}", "bK": "\\boldsymbol{K}", "bL": "\\boldsymbol{L}", "bM": "\\boldsymbol{M}", "bN": "\\boldsymbol{N}", "bO": "\\boldsymbol{O}", "bP": "\\boldsymbol{P}", "bQ": "\\boldsymbol{Q}", "bR": "\\boldsymbol{R}", "bS": "\\boldsymbol{S}", "bT": "\\boldsymbol{T}", "bU": "\\boldsymbol{U}", "bV": "\\boldsymbol{V}", "bW": "\\boldsymbol{W}", "bX": "\\boldsymbol{X}", "bY": "\\boldsymbol{Y}", "bZ": "\\boldsymbol{Z}", "balpha": "\\boldsymbol{\\alpha}", "bbeta": "\\boldsymbol{\\beta}", "bgamma": "\\boldsymbol{\\gamma}", "bdelta": "\\boldsymbol{\\delta}", "bepsilon": "\\boldsymbol{\\epsilon}", "bvarepsilon": "\\boldsymbol{\\varepsilon}", "bzeta": "\\boldsymbol{\\zeta}", "boeta": "\\boldsymbol{\\eta}", "btheta": "\\boldsymbol{\\theta}", "bvartheta": "\\boldsymbol{\\vartheta}", "biota": "\\boldsymbol{\\iota}", "bkappa": "\\boldsymbol{\\kappa}", "blambda": "\\boldsymbol{\\lambda}", "bmu": "\\boldsymbol{\\mu}", "bnu": "\\boldsymbol{\\nu}", "bxi": "\\boldsymbol{\\xi}", "bpi": "\\boldsymbol{\\pi}", "brho": "\\boldsymbol{\\rho}", "bvarrho": "\\boldsymbol{\\varrho}", "bsig": "\\boldsymbol{\\sigma}", "btau": "\\boldsymbol{\\tau}", "bupsilon": "\\boldsymbol{\\upsilon}", "bphi": "\\boldsymbol{\\phi}", "bvarphi": "\\boldsymbol{\\varphi}", "bchi": "\\boldsymbol{\\chi}", "bpsi": "\\boldsymbol{\\psi}", "bomega": "\\boldsymbol{\\omega}", "bGamma": "\\boldsymbol{\\Gamma}", "bDelta": "\\boldsymbol{\\Delta}", "bTheta": "\\boldsymbol{\\Theta}", "bLambda": "\\boldsymbol{\\Lambda}", "bXi": "\\boldsymbol{\\Xi}", "bPi": "\\boldsymbol{\\Pi}", "bSig": "\\boldsymbol{\\Sigma}", "bUpsilon": "\\boldsymbol{\\Upsilon}", "bPhi": "\\boldsymbol{\\Phi}", "bPsi": "\\boldsymbol{\\Psi}", "bOmega": "\\boldsymbol{\\Omega}", "Aa": "\\mathcal{A}", "Bb": "\\mathcal{B}", "Cc": "\\mathcal{C}", "Dd": "\\mathcal{D}", "Ee": "\\mathcal{E}", "Ff": "\\mathcal{F}", "Gg": "\\mathcal{G}", "Hh": "\\mathcal{H}", "Ii": "\\mathcal{I}", "Jj": "\\mathcal{J}", "Kk": "\\mathcal{K}", "Ll": "\\mathcal{L}", "Mm": "\\mathcal{M}", "Nn": "\\mathcal{N}", "Oo": "\\mathcal{O}", "Pp": "\\mathcal{P}", "Qq": "\\mathcal{Q}", "Rr": "\\mathcal{R}", "Ss": "\\mathcal{S}", "Tt": "\\mathcal{T}", "Uu": "\\mathcal{U}", "Vv": "\\mathcal{V}", "Ww": "\\mathcal{W}", "Xx": "\\mathcal{X}", "Yy": "\\mathcal{Y}", "Zz": "\\mathcal{Z}", "AA": "\\mathbb{A}", "BB": "\\mathbb{B}", "CC": "\\mathbb{C}", "DD": "\\mathbb{D}", "EE": "\\mathbb{E}", "FF": "\\mathbb{F}", "GG": "\\mathbb{G}", "HH": "\\mathbb{H}", "II": "\\mathbb{I}", "JJ": "\\mathbb{J}", "KK": "\\mathbb{K}", "LL": "\\mathbb{L}", "MM": "\\mathbb{M}", "NN": "\\mathbb{N}", "OO": "\\mathbb{O}", "PP": "\\mathbb{P}", "QQ": "\\mathbb{Q}", "RR": "\\mathbb{R}", "SS": "\\mathbb{S}", "TT": "\\mathbb{T}", "UU": "\\mathbb{U}", "VV": "\\mathbb{V}", "WW": "\\mathbb{W}", "XX": "\\mathbb{X}", "YY": "\\mathbb{Y}", "ZZ": "\\mathbb{Z}", "diff": "\\,\\text{d}", "div": "\\operatorname{div}", "dev": "\\operatorname{dev}", "sym": "\\operatorname{sym}", "diag": "\\operatorname{diag}", "skew": "\\operatorname{skew}", "tr": "\\operatorname{tr}", "cof": "\\operatorname{cof}", "T": "^{\\text{T}}", "utilde": "\\tilde{#1}", "uttilde": "\\tilde{\\tilde{#1}}", "tgrad": "\\utilde{\\nabla}", "dOm": "\\,\\text{d}\\Omega", "Neumann": "\\partial\\Omega_{\\text{N}}", "Dirichlet": "\\partial\\Omega_{\\text{D}}", "dt": "\\,\\text{d}t", "beps": "\\bvarepsilon", "epsi": "\\varepsilon", "bepsel": "\\bvarepsilon^{\\text{el}}", "bepsp": "\\bvarepsilon^{\\text{p}}", "bepsvp": "\\bvarepsilon^{\\text{vp}}", "epsp": "\\varepsilon^{\\text{p}}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'demos/neural_network_models/neural_GSM';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Nonlinear constitutive behaviors" href="../../concepts.html" />
    <link rel="prev" title="Physics-Augmented Neural Networks for data-driven hyperelasticity" href="hyperelastic_PANN.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/jaxmat_logo.svg" class="logo__image only-light" alt="jaxmat - Home"/>
    <img src="../../_static/jaxmat_logo.svg" class="logo__image only-dark pst-js-only" alt="jaxmat - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    Documentation
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Quickstart tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../quickstart/getting_started.html">Getting started with <code class="docutils literal notranslate"><span class="pre">jaxmat</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/batched_computation.html">Batching across material points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/material_parameters_batching.html">Batching across material parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pytrees.html">Composable and differentiable material models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../pheno_models.html">Phenomenological models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../phenomenological_models/Green_viscoplasticity.html">Norton viscoplastic model with a Green yield surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phenomenological_models/CamClay.html">Modified Cam-Clay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phenomenological_models/multisurface_plasticity.html">Multi-surface plasticity model</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../identification.html">Data-driven identification</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../identification/hardening_rule.html">Identification of a nonlinear isotropic hardening rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../identification/nonlinear_kinematic_hardening.html">Identification of a nonlinear hardening model from cyclic data</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../ml_models.html">Machine-learning based models</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hyperelastic_PANN.html">Physics-Augmented Neural Networks for data-driven hyperelasticity</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Neural Generalized Standard Material for viscoelasticity</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">General resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../concepts.html">Nonlinear constitutive behaviors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../computational.html">Computational aspects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tensors.html">Conventions for representing tensors</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../api/jaxmat.loader.html">jaxmat.loader module</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/jaxmat.materials.html">jaxmat.materials package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.materials.behavior.html">jaxmat.materials.behavior module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.materials.elasticity.html">jaxmat.materials.elasticity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.materials.elastoplasticity.html">jaxmat.materials.elastoplasticity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.materials.fe_fp_elastoplasticity.html">jaxmat.materials.fe_fp_elastoplasticity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.materials.viscoplasticity.html">jaxmat.materials.viscoplasticity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.materials.viscoelasticity.html">jaxmat.materials.viscoelasticity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.materials.generalized_standard.html">jaxmat.materials.generalized_standard module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.materials.hyperelasticity.html">jaxmat.materials.hyperelasticity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.materials.plastic_surfaces.html">jaxmat.materials.plastic_surfaces module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.materials.viscoplastic_flows.html">jaxmat.materials.viscoplastic_flows module</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/jaxmat.solvers.html">jaxmat.solvers package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.solvers.custom_newton.html">jaxmat.solvers.custom_newton module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.solvers.custom_optimistix_solvers.html">jaxmat.solvers.custom_optimistix_solvers</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/jaxmat.state.html">jaxmat.state module</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/jaxmat.tensors.html">jaxmat.tensors package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.tensors.generic_tensors.html">jaxmat.tensors.generic_tensors module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.tensors.linear_algebra.html">jaxmat.tensors.linear_algebra module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.tensors.tensor_utils.html">jaxmat.tensors.tensor_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/jaxmat.tensors.utils.html">jaxmat.tensors.utils module</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/bleyerj/jaxmat" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/bleyerj/jaxmat/edit/main/demos/neural_network_models/neural_GSM.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Neural Generalized Standard Material for viscoelasticity</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theoretical-background">Theoretical background</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generalized-standard-materials">Generalized Standard Materials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hybrid-neural-gsm-architecture">Hybrid neural GSM architecture</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ground-truth-data-generation">Ground-truth data generation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-neural-gsm">Defining the neural GSM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-procedure">Training procedure</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loss-function">Loss function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-strategy">Optimization strategy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-with-a-reduced-generalized-maxwell-model">Comparison with a reduced generalized Maxwell model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="neural-generalized-standard-material-for-viscoelasticity">
<h1>Neural Generalized Standard Material for viscoelasticity<a class="headerlink" href="#neural-generalized-standard-material-for-viscoelasticity" title="Link to this heading">#</a></h1>
<p>In this demo, we implement a Generalized Standard Material (GSM) model of viscoelasticity, in which part of the model is represented by a neural network. This approach follows the general idea proposed by <span id="id1">[<a class="reference internal" href="#id27" title="Moritz Flaschel, Paul Steinmann, Laura De Lorenzis, and Ellen Kuhl. Convex neural networks learn generalized standard material models. Journal of the Mechanics and Physics of Solids, 200:106103, 2025. doi:10.1016/j.jmps.2025.106103.">Flaschel <em>et al.</em>, 2025</a>]</span>, where neural convex potentials are embedded in thermodynamically consistent constitutive models.</p>
<p>The goal is to demonstrate how a data-driven, physics-constrained constitutive model can be trained to reproduce a reference viscoelastic response generated by a classical model, while keeping full consistency with the framework of generalized standard materials.</p>
<div class="important admonition">
<p class="admonition-title">Objectives</p>
<p>This demo shows:</p>
<ul class="simple">
<li><p>How to define a hybrid neural constitutive model following the GSM structure</p></li>
<li><p>How to generate synthetic viscoelastic data using a Generalized Maxwell model</p></li>
<li><p>How to train a neural dissipation potential while keeping a known free energy</p></li>
<li><p>How the number of internal variables affects the model’s ability to reproduce the true relaxation behavior</p></li>
</ul>
</div>
<p>To simplify the exposition, we focus exclusively on a viscoelastic material.
The reference (“ground truth”) data is produced using a Generalized Maxwell model with 6 branches, with randomly generated viscoelastic properties.</p>
<p>The training objective is to identify a neural GSM model with a reduced number of internal state variables, denoted <span class="math notranslate nohighlight">\(N_\text{var}\)</span>, while retaining the correct stress relaxation behavior. of internal state variables. The long-term elastic response is assumed to be known.</p>
<section id="theoretical-background">
<h2>Theoretical background<a class="headerlink" href="#theoretical-background" title="Link to this heading">#</a></h2>
<section id="generalized-standard-materials">
<h3>Generalized Standard Materials<a class="headerlink" href="#generalized-standard-materials" title="Link to this heading">#</a></h3>
<p>A generalized standard material <span id="id2">[<a class="reference internal" href="#id28" title="Bernard Halphen and Quoc Son Nguyen. Sur les matériaux standard généralisés. Journal de mécanique, 14(1):39–63, 1975. URL: https://hal.science/hal-03600755v1.">Halphen and Nguyen, 1975</a>]</span> is defined by a free energy potential <span class="math notranslate nohighlight">\(\Psi(\beps,\balpha)\)</span> and a dissipation potential <span class="math notranslate nohighlight">\(\Phi(\dot\balpha)\)</span>, from which all constitutive relations are derived in a thermodynamically consistent way. The internal state variable evolution over a time-step is obtained by minimizing a so-called <em>incremental potential</em> <span id="id3">[<a class="reference internal" href="#id29" title="Michael Ortiz and Laurent Stainier. The variational formulation of viscoplastic constitutive updates. Computer methods in applied mechanics and engineering, 171(3-4):419–444, 1999. doi:10.1016/S0045-7825(98)00219-9.">Ortiz and Stainier, 1999</a>]</span>:</p>
<div class="math notranslate nohighlight">
\[\min_{\Delta \balpha} J(\Delta\balpha ;\beps_{n+1},\balpha_n) = \min_{\Delta \balpha} \Psi(\beps_{n+1}, \balpha_n + \Delta \balpha)
    + \Delta t \Phi\left(\dfrac{\Delta \balpha}{\Delta t}\right)\]</div>
<p>subject to the current strain <span class="math notranslate nohighlight">\(\beps_{n+1} = \beps_n+\Delta\beps\)</span> and time increment <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
</section>
<section id="hybrid-neural-gsm-architecture">
<h3>Hybrid neural GSM architecture<a class="headerlink" href="#hybrid-neural-gsm-architecture" title="Link to this heading">#</a></h3>
<p>Here we consider a hybrid architecture inspired by the Generalized Maxwell model, in which:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_\text{var}\)</span> represents the number of viscous branches</p></li>
<li><p>each branch has a linear elastic spring with stiffness <span class="math notranslate nohighlight">\(\CC_i\)</span></p></li>
<li><p>the viscous effects are governed by a neural dissipation potential represented by an Input Convex Neural Network (ICNN) <span id="id4">[<a class="reference internal" href="#id18" title="Brandon Amos, Lei Xu, and J. Zico Kolter. Input convex neural networks. In Doina Precup and Yee Whye Teh, editors, Proceedings of the 34th International Conference on Machine Learning, volume 70 of Proceedings of Machine Learning Research, 146–155. PMLR, 06–11 Aug 2017. URL: https://proceedings.mlr.press/v70/amos17b.html.">Amos <em>et al.</em>, 2017</a>]</span>.</p></li>
</ul>
<p>The constitutive potentials are written as:</p>
<ul class="simple">
<li><p>free energy:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Psi(\beps,\balpha_i) = \dfrac{1}{2}\beps:\CC_0:\beps + \sum_{i=1}^{N_\text{var}}\dfrac{1}{2}(\beps-\balpha_i):\CC_i:(\beps-\balpha_i)
\]</div>
<ul class="simple">
<li><p>dissipation potential:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Phi(\dot{\balpha}_i) = \mathcal{N}_\text{ICNN}(\dot{\balpha}_1,\ldots,\dot{\balpha}_{N_\textrm{var}})
\]</div>
<p>Unlike the classical Maxwell model where each branch dissipates independently, the neural potential couples all internal variables through a single convex function <span class="math notranslate nohighlight">\(\Phi\)</span>. This allows for nonlinear and non-separable viscous interactions while ensuring that the model remains thermodynamically admissible.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ground truth generalized Maxwell model with <span class="math notranslate nohighlight">\(N\)</span> branches would be represented by the following potentials where the <span class="math notranslate nohighlight">\(\balpha_i\)</span> represent the viscous strains <span class="math notranslate nohighlight">\(\beps^\text{v}_i\)</span> in each branch:</p>
<ul class="simple">
<li><p>free energy:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Psi(\beps,\beps_i^\text{v}) = \dfrac{1}{2}\beps:\CC_0:\beps + \sum_{i=1}^{N}\dfrac{1}{2}(\beps-\beps_i^\text{v}):\CC_i:(\beps-\beps_i^\text{v})
\]</div>
<ul class="simple">
<li><p>dissipation potential:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Phi(\dot{\beps}_i^\text{v}) = \sum_{i=1}^N \dfrac{1}{2}\eta_i \dot{\beps}_i^\text{v}:\dot{\beps}_i^\text{v}
\]</div>
</div>
</section>
</section>
<section id="ground-truth-data-generation">
<h2>Ground-truth data generation<a class="headerlink" href="#ground-truth-data-generation" title="Link to this heading">#</a></h2>
<p>We first define the ground truth data from a generalized Maxwell model with <code class="docutils literal notranslate"><span class="pre">Nmax=6</span></code> branches. The viscous elements are generated so that their relaxation times are spaced within the interval <span class="math notranslate nohighlight">\(0.005\text{ s}\)</span>–<span class="math notranslate nohighlight">\(10\text{ s}\)</span> with random stiffness values. The synthetic stress–strain data obtained from this model will serve as our training target.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="n">jax</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_platform_name&quot;</span><span class="p">,</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">equinox</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">eqx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jaxmat.state</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_batched</span><span class="p">,</span> <span class="n">AbstractState</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jaxmat.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">partition_by_node_names</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jaxmat.tensors</span><span class="w"> </span><span class="kn">import</span> <span class="n">SymmetricTensor2</span><span class="p">,</span> <span class="n">main_invariants</span><span class="p">,</span> <span class="n">eigenvalues</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jaxmat.nn.icnn</span><span class="w"> </span><span class="kn">import</span> <span class="n">ICNN</span><span class="p">,</span> <span class="n">ICNNSkip</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jaxmat.materials</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">optimistix</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">optx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">optax</span>

<span class="n">E0</span><span class="p">,</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">70e3</span><span class="p">,</span> <span class="mf">0.3</span>
<span class="n">elastic_model</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">LinearElasticIsotropic</span><span class="p">(</span><span class="n">E0</span><span class="p">,</span> <span class="n">nu</span><span class="p">)</span>

<span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">key1</span><span class="p">,</span> <span class="n">key2</span><span class="p">,</span> <span class="n">key3</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">tau</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">E1</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tau</span><span class="p">),))</span><span class="o">*</span><span class="mf">10e3</span>
<span class="n">viscous_model</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">LinearElasticIsotropic</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">nu</span><span class="p">))</span>

<span class="n">material</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">GeneralizedMaxwell</span><span class="p">(</span>
    <span class="n">elasticity</span><span class="o">=</span><span class="n">elastic_model</span><span class="p">,</span>
    <span class="n">viscous_branches</span><span class="o">=</span><span class="n">viscous_model</span><span class="p">,</span>
    <span class="n">relaxation_times</span><span class="o">=</span><span class="n">tau</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To train the model, we consider a stress relaxation (recovery) test under constant shear strain: <span class="math notranslate nohighlight">\(\epsilon_{xy}=\gamma_r/2\)</span> with <span class="math notranslate nohighlight">\(\gamma_r=10^{-3}\)</span> applied over a time interval  <span class="math notranslate nohighlight">\(10^{-3}--10^2\text{ s}\)</span>. The time discretization is logarithmic to capture both the fast initial relaxation and the slower long-term response.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Nincr</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Nincr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">gamma_r</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">gamma_r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We define a general-purpose function <code class="docutils literal notranslate"><span class="pre">compute_evolution</span></code> that integrates the constitutive equations over time for a given strain path.
Starting from the initial state, the model is updated incrementally at each time step using the internal solver provided by <code class="docutils literal notranslate"><span class="pre">jaxmat</span></code> and returns the full stress history. By using <code class="docutils literal notranslate"><span class="pre">jax.lax.scan</span></code>, the loop over time increments is efficiently compiled by JAX, ensuring high performance and differentiability.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_evolution</span><span class="p">(</span><span class="n">material</span><span class="p">,</span> <span class="n">gamma_list</span><span class="p">,</span> <span class="n">times</span><span class="p">):</span>
    <span class="c1"># Initial material state</span>
    <span class="n">state0</span> <span class="o">=</span> <span class="n">material</span><span class="o">.</span><span class="n">init_state</span><span class="p">()</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="n">gamma</span><span class="p">,</span> <span class="n">dt_</span> <span class="o">=</span> <span class="n">args</span>
        <span class="c1"># Build symmetric strain tensor</span>
        <span class="n">new_eps</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">gamma</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>

        <span class="c1"># Create tensor object (assuming this is JAX-compatible)</span>
        <span class="n">new_eps</span> <span class="o">=</span> <span class="n">SymmetricTensor2</span><span class="p">(</span><span class="n">tensor</span><span class="o">=</span><span class="n">new_eps</span><span class="p">)</span>

        <span class="c1"># Update material response</span>
        <span class="n">new_stress</span><span class="p">,</span> <span class="n">new_state</span> <span class="o">=</span> <span class="n">material</span><span class="o">.</span><span class="n">constitutive_update</span><span class="p">(</span><span class="n">new_eps</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">dt_</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_state</span><span class="p">,</span> <span class="n">new_stress</span>

    <span class="c1"># Use lax.scan to loop over gamma_list efficiently</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">state0</span><span class="p">,</span> <span class="p">(</span><span class="n">gamma_list</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sig</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="defining-the-neural-gsm">
<h2>Defining the neural GSM<a class="headerlink" href="#defining-the-neural-gsm" title="Link to this heading">#</a></h2>
<p>The GSM model is composed of three parts:</p>
<ul class="simple">
<li><p>Free energy potential, defines the recoverable elastic energy stored in both the equilibrium and viscous branches.</p></li>
<li><p>Dissipation potential, modeled by an Input Convex Neural Network (ICNN) to ensure convexity with respect to strain rates.</p></li>
<li><p>Internal state variables, representing the viscous strain tensors <span class="math notranslate nohighlight">\(\balpha_i\)</span>.</p></li>
</ul>
<p>We first define the internal state PyTree as a batch of symmetric strain tensors <span class="math notranslate nohighlight">\(\balpha_i\)</span> representing the <span class="math notranslate nohighlight">\(N_\text{var}\)</span> viscous strains in each Maxwell-like branch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">InternalState</span><span class="p">(</span><span class="n">AbstractState</span><span class="p">):</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">SymmetricTensor2</span> <span class="o">=</span> <span class="n">eqx</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Viscoelastic strains.&quot;&quot;&quot;</span>
    <span class="n">Nvar</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">eqx</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">static</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Number of viscoelastic variables.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">make_batched</span><span class="p">(</span><span class="n">SymmetricTensor2</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nvar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The free energy is implemented as a sum of quadratic elastic contributions in the form of an <code class="docutils literal notranslate"><span class="pre">equinox.Module</span></code>. The free energy <code class="docutils literal notranslate"><span class="pre">__call__</span></code> function takes as arguments the total strain <span class="math notranslate nohighlight">\(\beps\)</span> (<code class="docutils literal notranslate"><span class="pre">eps</span></code>) and the PyTree (<code class="docutils literal notranslate"><span class="pre">isv</span></code>) of internal state variables <span class="math notranslate nohighlight">\((\balpha_i)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">FreeEnergy</span><span class="p">(</span><span class="n">eqx</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="n">elastic_model</span><span class="p">:</span> <span class="n">jm</span><span class="o">.</span><span class="n">AbstractLinearElastic</span>
    <span class="n">viscous_model</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jm</span><span class="o">.</span><span class="n">AbstractLinearElastic</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">isv</span><span class="p">):</span>

        <span class="n">alpha</span> <span class="o">=</span> <span class="n">isv</span><span class="o">.</span><span class="n">alpha</span>
        <span class="n">psi_el</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">eps</span> <span class="o">@</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elastic_model</span><span class="o">.</span><span class="n">C</span> <span class="o">@</span> <span class="n">eps</span><span class="p">))</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">viscous_free_energy</span><span class="p">(</span><span class="n">viscous_model</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
            <span class="n">eps_el</span> <span class="o">=</span> <span class="n">eps</span> <span class="o">-</span> <span class="n">alpha</span>
            <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">eps_el</span> <span class="o">@</span> <span class="p">(</span><span class="n">viscous_model</span><span class="o">.</span><span class="n">C</span> <span class="o">@</span> <span class="n">eps_el</span><span class="p">))</span>

        <span class="n">psi_v</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">viscous_free_energy</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">viscous_model</span><span class="p">,</span> <span class="n">alpha</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">psi_el</span> <span class="o">+</span> <span class="n">psi_v</span>
</pre></div>
</div>
</div>
</div>
<p>The dissipation potential is represented by an Input-Convex Neural Network (ICNN) which guarantees convexity through positive weights and nonnegative increasing activation functions.</p>
<p>Inspired by the Physics-Augmented Neural networks (PANN) approach for elasticity, we choose here as inputs of the network the second invariants <span class="math notranslate nohighlight">\(I_2(\balpha_i)\)</span> of the state variables. We also add a normalization term so that the thermodynamic force is zero for <span class="math notranslate nohighlight">\(\balpha_i=0\)</span>, modifying the potential as follows:</p>
<div class="math notranslate nohighlight">
\[
\Phi(\balpha_i) = \Nn_\text{ICNN}(\balpha_i) - \dfrac{\partial \Nn_\text{ICNN}}{\partial\balpha_i}(\balpha_i=0):\balpha_i
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ICNNDissipationPotential</span><span class="p">(</span><span class="n">ICNN</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">icnn_potential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_dot</span><span class="p">):</span>
        <span class="n">I1</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">I3</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">main_invariants</span><span class="p">)(</span><span class="n">alpha_dot</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="mf">1e3</span><span class="o">*</span><span class="n">I2</span><span class="p">)</span>
       
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isv_dot</span><span class="p">):</span>
        <span class="n">alpha_dot</span> <span class="o">=</span> <span class="n">isv_dot</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">tensor</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">icnn_potential</span><span class="p">(</span><span class="n">alpha_dot</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">jax</span><span class="o">.</span><span class="n">jvp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icnn_potential</span><span class="p">,</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">alpha_dot</span><span class="p">),),</span> <span class="p">(</span><span class="n">alpha_dot</span><span class="p">,))[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We build a list of candidate neural GSM models for  <span class="math notranslate nohighlight">\(N_\text{var}=1,2,3\)</span>. Each model shares the same known long-term stiffness, while the viscous stiffness values and neural potential parameters are initialized randomly. We select here only 8 neurons in a single hidden layer.</p>
<p>The idea is to assess how the complexity of the internal structure (i.e., the number of internal variables) affects the ability of the neural GSM to reproduce the reference relaxation behavior.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Nvar_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">gsm_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">Nvar</span> <span class="ow">in</span> <span class="n">Nvar_list</span><span class="p">:</span>
    <span class="n">hidden_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">icnn_dissipation_potential</span> <span class="o">=</span> <span class="n">ICNNDissipationPotential</span><span class="p">(</span><span class="n">Nvar</span><span class="p">,</span> <span class="n">hidden_dims</span><span class="p">,</span> <span class="n">key3</span><span class="p">)</span>
    <span class="n">E1_</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">key2</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">Nvar</span><span class="p">,))</span> <span class="o">*</span> <span class="mf">1e3</span>
    <span class="n">viscous_model</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">LinearElasticIsotropic</span><span class="p">(</span><span class="n">E1_</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">E1_</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">nu</span><span class="p">))</span>
    <span class="n">free_energy</span> <span class="o">=</span> <span class="n">FreeEnergy</span><span class="p">(</span><span class="n">elastic_model</span><span class="o">=</span><span class="n">elastic_model</span><span class="p">,</span> <span class="n">viscous_model</span><span class="o">=</span><span class="n">viscous_model</span><span class="p">)</span>
    <span class="n">internal_state</span> <span class="o">=</span> <span class="n">InternalState</span><span class="p">(</span><span class="n">Nvar</span><span class="o">=</span><span class="n">Nvar</span><span class="p">)</span>
    <span class="n">gsm_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">jm</span><span class="o">.</span><span class="n">GeneralizedStandardMaterial</span><span class="p">(</span>
            <span class="n">free_energy</span><span class="o">=</span><span class="n">free_energy</span><span class="p">,</span>
            <span class="n">dissipation_potential</span><span class="o">=</span><span class="n">icnn_dissipation_potential</span><span class="p">,</span>
            <span class="n">internal</span><span class="o">=</span><span class="n">internal_state</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="training-procedure">
<h2>Training procedure<a class="headerlink" href="#training-procedure" title="Link to this heading">#</a></h2>
<section id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Link to this heading">#</a></h3>
<p>Before training, we compute the ground truth response under the prescribed strain history obtained from the 6-branch Generalized Maxwell model. We generate synthetic white noise to this data. Finally, we compute the predicted stress response of the randomly initialized neural GSM (for <span class="math notranslate nohighlight">\(N_\text{var}=3\)</span>) and compare it with the ground truth and noisy data.</p>
<p>At this stage, the predicted stress does not match the target relaxation curve — the neural model’s dissipation potential is untrained and cannot yet capture the correct time-dependent decay.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sig_train</span> <span class="o">=</span> <span class="n">compute_evolution</span><span class="p">(</span><span class="n">material</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">times</span><span class="p">)</span>
<span class="n">sig_noise</span> <span class="o">=</span> <span class="n">SymmetricTensor2</span><span class="p">(</span><span class="n">tensor</span><span class="o">=</span><span class="n">sig_train</span><span class="o">.</span><span class="n">tensor</span> <span class="o">+</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">sig_train</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">sig_init</span> <span class="o">=</span> <span class="n">compute_evolution</span><span class="p">(</span><span class="n">gsm_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">times</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">sig_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;-C3&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ground truth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">sig_noise</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;oC3&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Noisy data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span>
    <span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
    <span class="n">sig_init</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;-k&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;Initialization $N_\textrm</span><span class="se">{{</span><span class="s2">var</span><span class="se">}}</span><span class="s2">=</span><span class="si">{</span><span class="n">Nvar</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time $t$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Shear stress $\sigma_</span><span class="si">{xy}</span><span class="s2">$ [MPa]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bd233b503b5a494ae53389b3196fd2e73081be662bba496d43c6232eaa161d7c.png" src="../../_images/bd233b503b5a494ae53389b3196fd2e73081be662bba496d43c6232eaa161d7c.png" />
</div>
</div>
</section>
<section id="loss-function">
<h3>Loss function<a class="headerlink" href="#loss-function" title="Link to this heading">#</a></h3>
<p>The training process aims to minimize the discrepancy between the predicted and target stress histories.
We use the mean-squared error (MSE) loss function on the whole stress tensors:</p>
<div class="math notranslate nohighlight">
\[
\mathcal{L}(\btheta) = \dfrac{1}{M}\sum_{k=1}^M \|\hat\bsig^{(k)}(\btheta) - \bsig^\text{data,(k)}\|^2
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat\bsig^{(k)}(\btheta)\)</span> denotes the predicted stress tensor by the neural GSM at time step <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\( \bsig^\text{data,(k)}\)</span> the corresponding target value.
As the stress evolution depends recursively on the internal variables, the loss is history-dependent.
Gradients are automatically computed by JAX through the full time integration and solver iterations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@eqx</span><span class="o">.</span><span class="n">filter_jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">loss</span><span class="p">(</span><span class="n">trainable</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="n">sig_data</span><span class="p">,</span> <span class="n">static</span> <span class="o">=</span> <span class="n">args</span>
    <span class="k">if</span> <span class="n">static</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">material_</span> <span class="o">=</span> <span class="n">trainable</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">material_</span> <span class="o">=</span> <span class="n">eqx</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">trainable</span><span class="p">,</span> <span class="n">static</span><span class="p">)</span>
    <span class="n">sig_hat</span> <span class="o">=</span> <span class="n">compute_evolution</span><span class="p">(</span><span class="n">material_</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">times</span><span class="p">)</span>
    <span class="n">loss_</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">l2_loss</span><span class="p">(</span><span class="n">sig_hat</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">sig_data</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">loss_</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="n">sig_hat</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="optimization-strategy">
<h3>Optimization strategy<a class="headerlink" href="#optimization-strategy" title="Link to this heading">#</a></h3>
<p>We employ an <code class="docutils literal notranslate"><span class="pre">optax</span></code> optimizer based on Adam with parameter-block RMS normalization, which rescales gradients according to their variance across model parameters.
This helps stabilize training in the presence of quantities with different physical magnitudes.</p>
<p>The optimization is wrapped in an <code class="docutils literal notranslate"><span class="pre">optimistix.OptaxMinimiser</span></code>, which provides a clean interface for running the differentiable solver loop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">5e-2</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
    <span class="n">optax</span><span class="o">.</span><span class="n">scale_by_adam</span><span class="p">(),</span>
    <span class="n">optax</span><span class="o">.</span><span class="n">scale_by_param_block_rms</span><span class="p">(),</span>
    <span class="n">optax</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="o">-</span><span class="n">learning_rate</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">max_steps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">optx</span><span class="o">.</span><span class="n">OptaxMinimiser</span><span class="p">(</span>
    <span class="n">optimizer</span><span class="p">,</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
    <span class="c1"># verbose=frozenset({&quot;loss&quot;, &quot;step_size&quot;}),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="results">
<h3>Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<p>Each neural GSM is trained independently against the same noisy reference data.</p>
<p>During training, the equilibrium elastic model is kept frozen (not trainable), the viscous stiffness values and ICNN parameters are updated to minimize the loss.</p>
<p>The backward-mode automatic differentiation (<code class="docutils literal notranslate"><span class="pre">jac=&quot;bwd&quot;</span></code>) option is used for efficiency, as we are minimizing a scalar loss function.
At the end of training, the trained parameters are combined with the static part to reconstruct the full model.</p>
<p>For each value of <span class="math notranslate nohighlight">\(N_\text{var}\)</span>, we plot the predicted relaxation curve against the ground truth data.</p>
<p>The model with a single viscoelastic strain fails in reproducing the whole relaxation curve, despite being able to represent more than a single relaxation term since the viscosity dissipation potentially is not necessarily quadratic.
Increasing <span class="math notranslate nohighlight">\(N_\text{var}\)</span> to 2 and 3 clearly improves the results. The trained neural GSM reproduces the full multi-timescale relaxation curve almost perfectly.</p>
<p>This demonstrates that the neural GSM can efficiently compress the complex 6-branch Maxwell response into a reduced number of internal variables, while maintaining full thermodynamic consistency.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">gsm</span><span class="p">,</span> <span class="n">Nvar</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">gsm_list</span><span class="p">,</span> <span class="n">Nvar_list</span><span class="p">):</span>

    <span class="n">trainable</span><span class="p">,</span> <span class="n">static</span> <span class="o">=</span> <span class="n">partition_by_node_names</span><span class="p">(</span><span class="n">gsm</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;free_energy.elastic_model&quot;</span><span class="p">])</span>

    <span class="n">sol</span> <span class="o">=</span> <span class="n">optx</span><span class="o">.</span><span class="n">minimise</span><span class="p">(</span>
        <span class="n">loss</span><span class="p">,</span>
        <span class="n">solver</span><span class="p">,</span>
        <span class="n">trainable</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">sig_noise</span><span class="p">,</span> <span class="n">static</span><span class="p">),</span>
        <span class="n">has_aux</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">throw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">max_steps</span><span class="o">=</span><span class="n">max_steps</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;jac&quot;</span><span class="p">:</span> <span class="s2">&quot;bwd&quot;</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">trained_params</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">value</span>
    <span class="k">if</span> <span class="n">static</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">trained_material</span> <span class="o">=</span> <span class="n">trained_params</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">trained_material</span> <span class="o">=</span> <span class="n">eqx</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">trained_params</span><span class="p">,</span> <span class="n">static</span><span class="p">)</span>
    <span class="n">sig_hat</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">aux</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">sig_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;-C3&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ground truth&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span>
        <span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
        <span class="n">sig_hat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;royalblue&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;Trained $N_\textrm</span><span class="se">{{</span><span class="s2">var</span><span class="se">}}</span><span class="s2">=</span><span class="si">{</span><span class="n">Nvar</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time $t$ [s]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Shear stress $\sigma_</span><span class="si">{xy}</span><span class="s2">$ [MPa]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/44a63b6c0636b7361c94c3df3a6938e6195eb4a6717997fe85b33382ca48e753.png" src="../../_images/44a63b6c0636b7361c94c3df3a6938e6195eb4a6717997fe85b33382ca48e753.png" />
<img alt="../../_images/b2974751ad48e383da638f209a24b0724ad53c78e1b299199b7d3ee82326edff.png" src="../../_images/b2974751ad48e383da638f209a24b0724ad53c78e1b299199b7d3ee82326edff.png" />
<img alt="../../_images/70ba6566c9a71e4620789f51fac3430731b92f6901202025774bb0c7f4f20ce9.png" src="../../_images/70ba6566c9a71e4620789f51fac3430731b92f6901202025774bb0c7f4f20ce9.png" />
</div>
</div>
</section>
</section>
<section id="comparison-with-a-reduced-generalized-maxwell-model">
<h2>Comparison with a reduced generalized Maxwell model<a class="headerlink" href="#comparison-with-a-reduced-generalized-maxwell-model" title="Link to this heading">#</a></h2>
<p>Finally, we can train in a very similar fashion a generalized Maxwell model with a reduced number of branches. Below, we show how to do it by fixing the values for the relaxation times and learning only the viscous branches stiffness values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maxwell_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Nmax_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="k">for</span> <span class="n">Nmax</span> <span class="ow">in</span> <span class="n">Nmax_list</span><span class="p">:</span>
    <span class="n">E1_</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">key2</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">Nmax</span><span class="p">,))</span> <span class="o">*</span> <span class="mf">1e3</span>
    <span class="n">tau_</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Nmax</span><span class="p">)</span>
    <span class="n">viscous_model</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">LinearElasticIsotropic</span><span class="p">(</span><span class="n">E1_</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">E1_</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">nu</span><span class="p">))</span>
    <span class="n">maxwell_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jm</span><span class="o">.</span><span class="n">GeneralizedMaxwell</span><span class="p">(</span><span class="n">elasticity</span><span class="o">=</span><span class="n">elastic_model</span><span class="p">,</span> <span class="n">viscous_branches</span><span class="o">=</span><span class="n">viscous_model</span><span class="p">,</span> <span class="n">relaxation_times</span><span class="o">=</span><span class="n">tau_</span><span class="p">))</span>

<span class="k">for</span> <span class="n">maxwell</span><span class="p">,</span> <span class="n">Nmax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">maxwell_list</span><span class="p">,</span> <span class="n">Nmax_list</span><span class="p">):</span>

    <span class="n">trainable</span><span class="p">,</span> <span class="n">static</span> <span class="o">=</span> <span class="n">partition_by_node_names</span><span class="p">(</span><span class="n">maxwell</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;elasticity&quot;</span><span class="p">,</span> <span class="s2">&quot;relaxation_times&quot;</span><span class="p">])</span>

    <span class="n">sol</span> <span class="o">=</span> <span class="n">optx</span><span class="o">.</span><span class="n">minimise</span><span class="p">(</span>
        <span class="n">loss</span><span class="p">,</span>
        <span class="n">solver</span><span class="p">,</span>
        <span class="n">trainable</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">sig_noise</span><span class="p">,</span> <span class="n">static</span><span class="p">),</span>
        <span class="n">has_aux</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">throw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">max_steps</span><span class="o">=</span><span class="n">max_steps</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;jac&quot;</span><span class="p">:</span> <span class="s2">&quot;bwd&quot;</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">trained_params</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">value</span>
    <span class="k">if</span> <span class="n">static</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">trained_material</span> <span class="o">=</span> <span class="n">trained_params</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">trained_material</span> <span class="o">=</span> <span class="n">eqx</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">trained_params</span><span class="p">,</span> <span class="n">static</span><span class="p">)</span>
    <span class="n">sig_hat</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">aux</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">sig_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;-C3&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ground truth&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span>
        <span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
        <span class="n">sig_hat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;forestgreen&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;Maxwell with $N=</span><span class="si">{</span><span class="n">Nmax</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time $t$ [s]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Shear stress $\sigma_</span><span class="si">{xy}</span><span class="s2">$ [MPa]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b9a0217461024b95086af948ac66d5fb11e5e9b3e5d31df7e4bd894655d625a5.png" src="../../_images/b9a0217461024b95086af948ac66d5fb11e5e9b3e5d31df7e4bd894655d625a5.png" />
<img alt="../../_images/4637c2509d0572c327d8547342c32c19d31b3d3bc150a6cb9ad95a102592d9ce.png" src="../../_images/4637c2509d0572c327d8547342c32c19d31b3d3bc150a6cb9ad95a102592d9ce.png" />
<img alt="../../_images/848d8ebfb2e10543e2b1ad2c0647249bcfe2c900c1076cbfa2854375c6ac2438.png" src="../../_images/848d8ebfb2e10543e2b1ad2c0647249bcfe2c900c1076cbfa2854375c6ac2438.png" />
</div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div class="docutils container" id="id5">
<div role="list" class="citation-list">
<div class="citation" id="id18" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">AXK17</a><span class="fn-bracket">]</span></span>
<p>Brandon Amos, Lei Xu, and J. Zico Kolter. Input convex neural networks. In Doina Precup and Yee Whye Teh, editors, <em>Proceedings of the 34th International Conference on Machine Learning</em>, volume 70 of Proceedings of Machine Learning Research, 146–155. PMLR, 06–11 Aug 2017. URL: <a class="reference external" href="https://proceedings.mlr.press/v70/amos17b.html">https://proceedings.mlr.press/v70/amos17b.html</a>.</p>
</div>
<div class="citation" id="id27" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">FSDLK25</a><span class="fn-bracket">]</span></span>
<p>Moritz Flaschel, Paul Steinmann, Laura De Lorenzis, and Ellen Kuhl. Convex neural networks learn generalized standard material models. <em>Journal of the Mechanics and Physics of Solids</em>, 200:106103, 2025. <a class="reference external" href="https://doi.org/10.1016/j.jmps.2025.106103">doi:10.1016/j.jmps.2025.106103</a>.</p>
</div>
<div class="citation" id="id28" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">HN75</a><span class="fn-bracket">]</span></span>
<p>Bernard Halphen and Quoc Son Nguyen. Sur les matériaux standard généralisés. <em>Journal de mécanique</em>, 14(1):39–63, 1975. URL: <a class="reference external" href="https://hal.science/hal-03600755v1">https://hal.science/hal-03600755v1</a>.</p>
</div>
<div class="citation" id="id29" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">OS99</a><span class="fn-bracket">]</span></span>
<p>Michael Ortiz and Laurent Stainier. The variational formulation of viscoplastic constitutive updates. <em>Computer methods in applied mechanics and engineering</em>, 171(3-4):419–444, 1999. <a class="reference external" href="https://doi.org/10.1016/S0045-7825(98)00219-9">doi:10.1016/S0045-7825(98)00219-9</a>.</p>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./demos/neural_network_models"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="hyperelastic_PANN.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Physics-Augmented Neural Networks for data-driven hyperelasticity</p>
      </div>
    </a>
    <a class="right-next"
       href="../../concepts.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Nonlinear constitutive behaviors</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theoretical-background">Theoretical background</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generalized-standard-materials">Generalized Standard Materials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hybrid-neural-gsm-architecture">Hybrid neural GSM architecture</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ground-truth-data-generation">Ground-truth data generation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-neural-gsm">Defining the neural GSM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-procedure">Training procedure</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loss-function">Loss function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-strategy">Optimization strategy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-with-a-reduced-generalized-maxwell-model">Comparison with a reduced generalized Maxwell model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jeremy Bleyer
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>